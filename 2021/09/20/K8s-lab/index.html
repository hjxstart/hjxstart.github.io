<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>K8s_lab | 黄金贤的博客</title>
  <meta name="keywords" content="">
  <meta name="description" content="K8s_lab | 黄金贤的博客">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="概述# PHP是一种运行在服务器端的脚步语言，可以嵌入到HTML中。是一中面向对象的、解释的。7.3版本比较好用 # 1994年   环境准备# 安装 PhpStorm # https:&#x2F;&#x2F;3.jetbra.in&#x2F; 下载安装包 jetbra.zip 解压后放在 PhpStorm 的bin目录下, 为 jetbra 目录 # 双击 \bin\jetbra\scripts\install-all-us">
<meta property="og:type" content="article">
<meta property="og:title" content="Php">
<meta property="og:url" content="https://hjxstart.github.io/2025/09/13/Php/index.html">
<meta property="og:site_name" content="黄金贤的博客">
<meta property="og:description" content="概述# PHP是一种运行在服务器端的脚步语言，可以嵌入到HTML中。是一中面向对象的、解释的。7.3版本比较好用 # 1994年   环境准备# 安装 PhpStorm # https:&#x2F;&#x2F;3.jetbra.in&#x2F; 下载安装包 jetbra.zip 解压后放在 PhpStorm 的bin目录下, 为 jetbra 目录 # 双击 \bin\jetbra\scripts\install-all-us">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hjxstart/PicGo@main/img/20250913234353519.png">
<meta property="article:published_time" content="2025-09-13T15:10:00.000Z">
<meta property="article:modified_time" content="2025-10-08T11:23:27.820Z">
<meta property="article:author" content="黄金贤">
<meta property="article:tag" content="计算机网络 数据库 操作系统 数据结构 算法 Java Nodejs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hjxstart/PicGo@main/img/20250913234353519.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>


<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 8.0.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>黄金贤</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/hjxstart"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:hjxstart@126.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=1726283687&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(66)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="运维">
                        
                        运维
                        <small>(20)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="开发">
                        
                        开发
                        <small>(12)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="读书">
                        
                        读书
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="安全">
                        
                        安全
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="工具">
                        
                        工具
                        <small>(10)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="数据库">
                        
                        数据库
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="网络">
                        
                        网络
                        <small>(14)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="66">
<input type="hidden" id="yelog_site_word_count" value="253.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://github.com/hjxstart">hjxstart</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a id="top" class="全部文章 网络 "
           href="/2024/05/06/HCIE%20Lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HCIE Lab">HCIE Lab</span>
            <span class="post-date" title="2024-05-06 19:42:00">2024/05/06</span>
        </a>
        
        <a id="top" class="全部文章 安全 "
           href="/2025/08/17/PTE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PTE">PTE</span>
            <span class="post-date" title="2025-08-17 11:12:00">2025/08/17</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2021/09/09/VMware/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="VMware">VMware</span>
            <span class="post-date" title="2021-09-09 15:38:00">2021/09/09</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2025/04/04/PXE-Kickstart/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PXE+Kickstart">PXE+Kickstart</span>
            <span class="post-date" title="2025-04-04 10:45:00">2025/04/04</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2025/02/12/KylinOS/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="KylinOS">KylinOS</span>
            <span class="post-date" title="2025-02-12 16:47:00">2025/02/12</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2025/08/24/KylinOS-FAQ/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="KylinOS FAQ">KylinOS FAQ</span>
            <span class="post-date" title="2025-08-24 11:07:00">2025/08/24</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2025/08/24/Windows/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Windows">Windows</span>
            <span class="post-date" title="2025-08-24 11:19:00">2025/08/24</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2022/03/24/Linux/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Linux">Linux</span>
            <span class="post-date" title="2022-03-24 11:53:00">2022/03/24</span>
        </a>
        
        <a id="top" class="全部文章 工具 "
           href="/2024/07/28/NTLite/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NTLite">NTLite</span>
            <span class="post-date" title="2024-07-28 21:32:00">2024/07/28</span>
        </a>
        
        <a id="top" class="全部文章 数据库 "
           href="/2020/03/19/MySQL/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MySQL">MySQL</span>
            <span class="post-date" title="2020-03-19 21:51:00">2020/03/19</span>
        </a>
        
        <a id="top" class="全部文章 开发 "
           href="/2025/09/13/Php/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Php">Php</span>
            <span class="post-date" title="2025-09-13 23:10:00">2025/09/13</span>
        </a>
        
        <a id="top" class="全部文章 运维 "
           href="/2023/05/13/IBMC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="IBMC">IBMC</span>
            <span class="post-date" title="2023-05-13 21:04:00">2023/05/13</span>
        </a>
        
        <a  class="全部文章 安全 "
           href="/2025/08/21/cisp-practice/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="cisp-practice">cisp-practice</span>
            <span class="post-date" title="2025-08-21 19:41:00">2025/08/21</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2025/04/24/OpenStack/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="OpenStack">OpenStack</span>
            <span class="post-date" title="2025-04-24 09:04:00">2025/04/24</span>
        </a>
        
        <a  class="全部文章 安全 "
           href="/2024/08/23/CISO/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CISO">CISO</span>
            <span class="post-date" title="2024-08-23 19:29:00">2024/08/23</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/04/16/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E5%B8%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="网络工程师">网络工程师</span>
            <span class="post-date" title="2024-04-16 22:14:00">2024/04/16</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/01/27/STP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="STP">STP</span>
            <span class="post-date" title="2024-01-27 14:01:00">2024/01/27</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/01/27/VLAN/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="VLAN">VLAN</span>
            <span class="post-date" title="2024-01-27 11:42:00">2024/01/27</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/01/27/LLDP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="LLDP">LLDP</span>
            <span class="post-date" title="2024-01-27 11:31:00">2024/01/27</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/01/27/Telnet/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Telnet">Telnet</span>
            <span class="post-date" title="2024-01-27 10:45:00">2024/01/27</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2024/01/27/SSH/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SSH">SSH</span>
            <span class="post-date" title="2024-01-27 10:44:00">2024/01/27</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2023/12/22/WireGuard/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="WireGuard">WireGuard</span>
            <span class="post-date" title="2023-12-22 07:40:00">2023/12/22</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/12/21/Stack-Port/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Stack Port">Stack Port</span>
            <span class="post-date" title="2023-12-21 19:31:00">2023/12/21</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2023/12/18/RouterOS/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RouterOS">RouterOS</span>
            <span class="post-date" title="2023-12-18 17:05:00">2023/12/18</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2023/12/18/Git/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GIT">GIT</span>
            <span class="post-date" title="2023-12-18 17:00:00">2023/12/18</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2023/11/30/HelpDesk/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HelpDesk">HelpDesk</span>
            <span class="post-date" title="2023-11-30 21:21:00">2023/11/30</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2023/11/18/OpenWrt/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="OpenWrt">OpenWrt</span>
            <span class="post-date" title="2023-11-18 17:03:00">2023/11/18</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/06/01/HCNP-Lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="华为NP网络实验">华为NP网络实验</span>
            <span class="post-date" title="2023-06-01 10:46:04">2023/06/01</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/06/01/CCNP-Lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CCNP Lab">CCNP Lab</span>
            <span class="post-date" title="2023-06-01 10:46:00">2023/06/01</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2023/04/26/1Panel/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="1Panel">1Panel</span>
            <span class="post-date" title="2023-04-26 14:09:00">2023/04/26</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/04/08/HCNA-Lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HCNA Lab">HCNA Lab</span>
            <span class="post-date" title="2023-04-08 11:46:00">2023/04/08</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/04/07/CCNA-Lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CCNA Lab">CCNA Lab</span>
            <span class="post-date" title="2023-04-07 20:13:29">2023/04/07</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2023/04/07/OSPF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="OSPF">OSPF</span>
            <span class="post-date" title="2023-04-07 19:19:00">2023/04/07</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2022/08/12/HomeLab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="HomeLab">HomeLab</span>
            <span class="post-date" title="2022-08-12 15:09:00">2022/08/12</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2022/08/10/FRP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="FRP">FRP</span>
            <span class="post-date" title="2022-08-10 10:22:24">2022/08/10</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2022/07/28/WDS-MDT/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="WDS+MDT">WDS+MDT</span>
            <span class="post-date" title="2022-07-28 21:33:00">2022/07/28</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2022/06/21/Anaconda/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Anaconda">Anaconda</span>
            <span class="post-date" title="2022-06-21 20:56:00">2022/06/21</span>
        </a>
        
        <a  class="全部文章 网络 "
           href="/2022/05/25/%E7%BD%91%E7%BB%9C%E8%A7%84%E5%88%92%E5%B8%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="网络规划师">网络规划师</span>
            <span class="post-date" title="2022-05-25 11:57:00">2022/05/25</span>
        </a>
        
        <a  class="全部文章 数据库 "
           href="/2022/03/14/influxDB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="InfluxDB">InfluxDB</span>
            <span class="post-date" title="2022-03-14 13:25:00">2022/03/14</span>
        </a>
        
        <a  class="全部文章 数据库 "
           href="/2022/03/06/MongoDB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MongoDB">MongoDB</span>
            <span class="post-date" title="2022-03-06 17:38:00">2022/03/06</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2021/12/27/VIM/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="VIM">VIM</span>
            <span class="post-date" title="2021-12-27 09:15:00">2021/12/27</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/12/16/vsftpd/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="VSFTPD">VSFTPD</span>
            <span class="post-date" title="2021-12-16 08:49:00">2021/12/16</span>
        </a>
        
        <a  class="全部文章 数据库 "
           href="/2021/10/06/Redis/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="REDIS">REDIS</span>
            <span class="post-date" title="2021-10-06 17:19:00">2021/10/06</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/09/20/K8s-lab/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="K8s_lab">K8s_lab</span>
            <span class="post-date" title="2021-09-20 08:04:00">2021/09/20</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/09/15/K8s/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="K8s">K8s</span>
            <span class="post-date" title="2021-09-15 20:48:00">2021/09/15</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/09/08/Ingress/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ingress">Ingress</span>
            <span class="post-date" title="2021-09-08 23:56:00">2021/09/08</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/09/08/Harbor/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Harbor">Harbor</span>
            <span class="post-date" title="2021-09-08 18:04:00">2021/09/08</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/08/26/GO/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Go">Go</span>
            <span class="post-date" title="2021-08-26 11:50:00">2021/08/26</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/08/15/Java%E5%A4%9A%E7%BA%BF%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java多线程">Java多线程</span>
            <span class="post-date" title="2021-08-15 14:36:00">2021/08/15</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/08/11/Nginx/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Nginx">Nginx</span>
            <span class="post-date" title="2021-08-11 23:28:00">2021/08/11</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/08/06/Maven/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven">Maven</span>
            <span class="post-date" title="2021-08-06 09:38:00">2021/08/06</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/07/31/Springboot%E9%A1%B9%E7%9B%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Springboot项目">Springboot项目</span>
            <span class="post-date" title="2021-07-31 19:34:00">2021/07/31</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/07/22/Docker/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Docker">Docker</span>
            <span class="post-date" title="2021-07-22 14:53:00">2021/07/22</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/07/19/SpringSecurity/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringSecurity">SpringSecurity</span>
            <span class="post-date" title="2021-07-19 20:58:00">2021/07/19</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/07/13/Mybatis/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mybatis">Mybatis</span>
            <span class="post-date" title="2021-07-13 10:38:00">2021/07/13</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/07/05/NVM/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NVM">NVM</span>
            <span class="post-date" title="2021-07-05 08:15:00">2021/07/05</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/06/26/Java-Project/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java Project">Java Project</span>
            <span class="post-date" title="2021-06-26 07:58:00">2021/06/26</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/06/23/Vue/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Vue">Vue</span>
            <span class="post-date" title="2021-06-23 10:48:00">2021/06/23</span>
        </a>
        
        <a  class="全部文章 开发 "
           href="/2021/06/08/SpringBoot2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot2">SpringBoot2</span>
            <span class="post-date" title="2021-06-08 16:51:00">2021/06/08</span>
        </a>
        
        <a  class="全部文章 运维 "
           href="/2021/06/07/CentOS7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CentOS7">CentOS7</span>
            <span class="post-date" title="2021-06-07 23:16:00">2021/06/07</span>
        </a>
        
        <a  class="全部文章 读书 "
           href="/2021/04/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="设计模式">设计模式</span>
            <span class="post-date" title="2021-04-18 22:19:00">2021/04/18</span>
        </a>
        
        <a  class="全部文章 数据库 "
           href="/2021/03/22/SQL/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SQL">SQL</span>
            <span class="post-date" title="2021-03-22 18:33:00">2021/03/22</span>
        </a>
        
        <a  class="全部文章 读书 "
           href="/2021/03/14/%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="时间管理">时间管理</span>
            <span class="post-date" title="2021-03-14 21:49:00">2021/03/14</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2021/03/14/Hexo/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hexo">Hexo</span>
            <span class="post-date" title="2021-03-14 08:31:00">2021/03/14</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2020/09/12/UltraISO/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="UltraISO">UltraISO</span>
            <span class="post-date" title="2020-09-12 11:42:00">2020/09/12</span>
        </a>
        
        <a  class="全部文章 工具 "
           href="/2020/09/12/Ventoy/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Ventoy">Ventoy</span>
            <span class="post-date" title="2020-09-12 11:42:00">2020/09/12</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-K8s-lab" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">K8s_lab</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="运维">运维</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2025-10-08 19:23:27'>2021-09-20 08:04</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:2.4k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-k8s-install"><span class="toc-text">第一章 k8s install</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E8%AF%A5%E6%96%87%E5%9F%BA%E4%BA%8Ek8s%E4%B8%89%E4%BB%B6%E5%A5%97%E4%BB%A5%E4%B8%8B%E7%89%88%E6%9C%AC"><span class="toc-text">1.1 该文基于k8s三件套以下版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85docker"><span class="toc-text">1.2 安装docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-only-centos-use"><span class="toc-text">1.3 only centos use</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E6%9B%B4%E6%8D%A2k8s-yum%E6%BA%90"><span class="toc-text">1.4 更换k8s yum源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-%E5%AE%89%E8%A3%85-k8s%E4%B8%89%E4%BB%B6%E5%A5%97"><span class="toc-text">1.5 安装 k8s三件套</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-%E7%BC%96%E8%BE%91docker%E6%96%87%E4%BB%B6"><span class="toc-text">1.6 编辑docker文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7-%E8%AE%BE%E7%BD%AEdocker-pull-%E4%BB%A3%E7%90%86"><span class="toc-text">1.7 设置docker pull 代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8-%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F"><span class="toc-text">1.8 下载镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-9-%E5%88%9B%E5%BB%BA%E9%9B%86%E7%BE%A4"><span class="toc-text">1.9 创建集群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-10-%E5%85%B6%E4%BB%96%E6%9C%BA%E5%99%A8%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">1.10 其他机器加入集群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-11-%E6%B5%8B%E8%AF%95"><span class="toc-text">1.11 测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-k8s-DashBoard"><span class="toc-text">第二章 k8s DashBoard</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%AE%89%E8%A3%85DashBoard"><span class="toc-text">2.1 安装DashBoard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E7%94%9F%E6%88%90token"><span class="toc-text">2.2 生成token</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E6%9F%A5%E7%9C%8BDashboard%E8%BF%90%E8%A1%8C%E7%9A%84%E7%AB%AF%E5%8F%A3"><span class="toc-text">2.3 查看Dashboard运行的端口</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-kubesphere"><span class="toc-text">第三章 kubesphere</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-kubesphere-%E5%89%8D%E7%BD%AE%E8%A6%81%E6%B1%82"><span class="toc-text">3.1 kubesphere 前置要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-k8s%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-text">3.2 k8s安装指定的版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B"><span class="toc-text">3.3 创建存储类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E5%88%9B%E5%BB%BAnfs%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-text">3.4 创建nfs服务端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BD%BF%E7%94%A8nfs"><span class="toc-text">3.5 客户端使用nfs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-%E5%AE%89%E8%A3%85kubeSphere"><span class="toc-text">3.6 安装kubeSphere</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-error"><span class="toc-text">第四章 error</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E5%85%B3%E4%BA%8Eprometheus-k8s-0-%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5%EF%BC%8C%E4%B8%80%E7%9B%B4-pending-%E7%8A%B6%E6%80%81%E3%80%82"><span class="toc-text">4.1 关于prometheus-k8s-0 启动失败，一直 pending 状态。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-cni0%E9%97%AE%E9%A2%98"><span class="toc-text">4.2 cni0问题</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="第一章-k8s-install"><a href="#第一章-k8s-install" class="headerlink" title="第一章 k8s install"></a>第一章 k8s install</h1><h2 id="1-1-该文基于k8s三件套以下版本"><a href="#1-1-该文基于k8s三件套以下版本" class="headerlink" title="1.1 该文基于k8s三件套以下版本"></a>1.1 该文基于k8s三件套以下版本</h2><blockquote>
<p>kubectl v1.20.1-0<br>kubeadm v1.20.1-0<br>kubelet v1.20.1-0</p>
</blockquote>
<hr>
<h2 id="1-2-安装docker"><a href="#1-2-安装docker" class="headerlink" title="1.2 安装docker"></a>1.2 安装docker</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">安装docker所需的工具</span>
yum install -y yum-utils device-mapper-persistent-data lvm2
<span class="hljs-meta prompt_"># </span><span class="language-bash">配置阿里云的docker源</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
<span class="hljs-meta prompt_"># </span><span class="language-bash">指定安装这个版本的docker-ce</span>
yum install -y docker-ce-18.09.9-3.el7
<span class="hljs-meta prompt_"># </span><span class="language-bash">启动docker</span>
systemctl enable docker &amp;&amp; systemctl start docker
language-shell复制代码</code></pre>

<hr>
<h2 id="1-3-only-centos-use"><a href="#1-3-only-centos-use" class="headerlink" title="1.3 only centos use"></a>1.3 only centos use</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">关闭防火墙</span>
systemctl disable firewalld
systemctl stop firewalld
<span class="hljs-meta prompt_"># </span><span class="language-bash">关闭selinux</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">临时禁用selinux</span>
setenforce 0
<span class="hljs-meta prompt_"># </span><span class="language-bash">永久关闭 修改/etc/sysconfig/selinux文件设置</span>
sed -i &#x27;s/SELINUX=permissive/SELINUX=disabled/&#x27; /etc/sysconfig/selinux
sed -i &quot;s/SELINUX=enforcing/SELINUX=disabled/g&quot; /etc/selinux/config
<span class="hljs-meta prompt_"># </span><span class="language-bash">禁用交换分区</span>
swapoff -a
<span class="hljs-meta prompt_"># </span><span class="language-bash">永久禁用，打开/etc/fstab注释掉swap那一行。</span>
sed -i &#x27;s/.*swap.*/#&amp;/&#x27; /etc/fstab
<span class="hljs-meta prompt_"># </span><span class="language-bash">修改内核参数</span>
cat &lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
sysctl --system

cat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf
br_netfilter
EOF

cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
sudo sysctl --system
language-shell复制代码</code></pre>

<hr>
<h2 id="1-4-更换k8s-yum源"><a href="#1-4-更换k8s-yum源" class="headerlink" title="1.4 更换k8s yum源"></a>1.4 更换k8s yum源</h2><pre><code class="hljs shell">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF
language-shell复制代码</code></pre>

<hr>
<h2 id="1-5-安装-k8s三件套"><a href="#1-5-安装-k8s三件套" class="headerlink" title="1.5 安装 k8s三件套"></a>1.5 安装 k8s三件套</h2><pre><code class="hljs shell">yum install -y kubelet-1.20.1-0 kubeadm-1.20.1-0 kubectl-1.20.1-0 --disableexcludes=kubernetes
systemctl enable --now kubelet
language-shell复制代码</code></pre>

<hr>
<h2 id="1-6-编辑docker文件"><a href="#1-6-编辑docker文件" class="headerlink" title="1.6 编辑docker文件"></a>1.6 编辑docker文件</h2><pre><code class="hljs bash"><span class="hljs-comment"># 创建文件 </span>
vim /etc/docker/daemon.json
<span class="hljs-comment"># 并写入</span>
&#123;
    <span class="hljs-string">&quot;exec-opts&quot;</span>: [<span class="hljs-string">&quot;native.cgroupdriver=systemd&quot;</span>]
&#125;
</code></pre>

<hr>
<h2 id="1-7-设置docker-pull-代理"><a href="#1-7-设置docker-pull-代理" class="headerlink" title="1.7 设置docker pull 代理"></a>1.7 设置docker pull 代理</h2><pre><code class="hljs bash"><span class="hljs-comment"># 设置docker代理</span>
<span class="hljs-built_in">mkdir</span> -p /etc/systemd/system/docker.service.d
vim proxy.conf
<span class="hljs-comment"># 输入以下内容</span>
[Service]
Environment=<span class="hljs-string">&quot;HTTP_PROXY=http://192.168.18.140:8889/&quot;</span>
Environment=<span class="hljs-string">&quot;HTTPS_PROXY=http://192.168.18.140:8889/&quot;</span>
Environment=<span class="hljs-string">&quot;NO_PROXY=localhost,127.0.0.1,192.168.18.140&quot;</span>

systemctl daemon-reload
systemctl restart docker
</code></pre>

<hr>
<h2 id="1-8-下载镜像"><a href="#1-8-下载镜像" class="headerlink" title="1.8 下载镜像"></a>1.8 下载镜像</h2><pre><code class="hljs shell">kubeadm config images pull
<span class="hljs-meta prompt_"># </span><span class="language-bash">可能不需要执行下面的命令</span>
docker pull quay.mirrors.ustc.edu.cn/coreos/flannel:v0.14.0
docker tag quay.mirrors.ustc.edu.cn/coreos/flannel:v0.14.0  quay.io/coreos/flannel:v0.14.0
docker rmi quay.mirrors.ustc.edu.cn/coreos/flannel:v0.14.0
language-shell复制代码</code></pre>

<hr>
<h2 id="1-9-创建集群"><a href="#1-9-创建集群" class="headerlink" title="1.9 创建集群"></a>1.9 创建集群</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">在master上创建集群</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">192.168.018.200为masteip；10.244.0.0/16为pod地址池；kubeadm-config.yaml是配置 kubelet 的 cgroup 驱动的文件</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">kubeadm init --apiserver-advertise-address 192.168.18.200 --pod-network-cidr=10.244.0.0/16 --config kubeadm-config.yaml</span>
kubeadm init --apiserver-advertise-address 192.168.18.200 --pod-network-cidr=10.244.0.0/16
<span class="hljs-meta prompt_"># </span><span class="language-bash">接着还需要执行如下命令安装 Pod 网络（这里我们使用 flannel），否则 Pod 之间无法通信。</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml需要科学上网才能访问，</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">可在你的电脑访问后，在master服务器上创建kube-flannel.yaml后，粘贴进去。</span>
kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">查看节点状态，状态必须为ready</span>
kubectl get nodes
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">查看加入集群的命令</span>
kubeadm token create --print-join-command
language-shell复制代码</code></pre>

<hr>
<h2 id="1-10-其他机器加入集群"><a href="#1-10-其他机器加入集群" class="headerlink" title="1.10 其他机器加入集群"></a>1.10 其他机器加入集群</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">在其他节点中执行1~8的步骤</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">执行第9步骤中加入集群的命令，类似以下的命令</span>
kubeadm join 192.168.18.200:6443 --token opip9p.rh35kkvqzwjizely --discovery-token-ca-cert-hash sha256:9252e13d2ffd3569c40b02c477f59038fac39aade9e99f282a333c0f8c5d7b22
language-shell复制代码</code></pre>

<h2 id="1-11-测试"><a href="#1-11-测试" class="headerlink" title="1.11 测试"></a>1.11 测试</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">https://raw.githubusercontent.com/kubernetes/website/master/content/en/examples/application/nginx-app.yaml需要科学上网才能访问，</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">可在你的电脑访问后，在master服务器上创建nginx-app.yaml后，粘贴进去。</span>
kubectl apply -f https://raw.githubusercontent.com/kubernetes/website/master/content/en/examples/application/nginx-app.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">执行如下命令查看副本（pod）情况</span>
kubectl get pods -o wide
<span class="hljs-meta prompt_"># </span><span class="language-bash">执行如下命令则可以查看 services 状态。</span>
kubectl get service
language-shell复制代码</code></pre>

<hr>
<h1 id="第二章-k8s-DashBoard"><a href="#第二章-k8s-DashBoard" class="headerlink" title="第二章 k8s DashBoard"></a>第二章 k8s DashBoard</h1><h2 id="2-1-安装DashBoard"><a href="#2-1-安装DashBoard" class="headerlink" title="2.1 安装DashBoard"></a>2.1 安装DashBoard</h2><pre><code class="hljs yaml"><span class="hljs-comment"># 用浏览器打开以下文件并复制</span>
<span class="hljs-comment"># https://kuboard.cn/install-script/k8s-dashboard/v2.0.0-beta5.yaml</span>
<span class="hljs-comment"># 打开你的电脑创建dashboard.yaml</span>
<span class="hljs-comment"># 粘贴复制的内容</span>
<span class="hljs-comment"># 找到以下内容</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">k8s-app:</span> <span class="hljs-string">kubernetes-dashboard</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">kubernetes-dashboard</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">kubernetes-dashboard</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">443</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8443</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">NodePort</span> <span class="hljs-comment"># 加入这一行，使用NodePort模式</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">k8s-app:</span> <span class="hljs-string">kubernetes-dashboard</span>
<span class="hljs-string">language-yaml复制代码</span></code></pre>

<hr>
<h2 id="2-2-生成token"><a href="#2-2-生成token" class="headerlink" title="2.2 生成token"></a>2.2 生成token</h2><pre><code class="hljs shell">kubectl apply -f https://kuboard.cn/install-script/k8s-dashboard/auth.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">查看token值</span>
kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin-user | awk &#x27;&#123;print $1&#125;&#x27;)
language-shell复制代码</code></pre>

<p>生成类似以下的内容</p>
<pre><code class="hljs shell">Name:         admin-user-token-v57nw
Namespace:    kubernetes-dashboard
Labels:       &lt;none&gt;
Annotations:  kubernetes.io/service-account.name: admin-user
              kubernetes.io/service-account.uid: 0303243c-4040-4a58-8a47-849ee9ba79c1

Type:  kubernetes.io/service-account-token

Data
====
ca.crt:     1066 bytes
namespace:  20 bytes
token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXY1N253Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzAzMjQzYy00MDQwLTRhNTgtOGE0Ny04NDllZTliYTc5YzEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.Z2JrQlitASVwWbc-s6deLRFVk5DWD3P_vjUFXsqVSY10pbjFLG4njoZwh8p3tLxnX_VBsr7_6bwxhWSYChp9hwxznemD5x5HLtjb16kI9Z7yFWLtohzkTwuFbqmQaMoget_nYcQBUC5fDmBHRfFvNKePh_vSSb2h_aYXa8GV5AcfPQpY7r461itme1EXHQJqv-SN-zUnguDguCTjD80pFZ_CmnSE1z9QdMHPB8hoB4V68gtswR1VLa6mSYdgPwCHauuOobojALSaMc3RH7MmFUumAgguhqAkX3Omqd3rJbYOMRuMjhANqd08piDC3aIabINX6gP5-Tuuw2svnV6NYQ
language-shell复制代码</code></pre>

<hr>
<h2 id="2-3-查看Dashboard运行的端口"><a href="#2-3-查看Dashboard运行的端口" class="headerlink" title="2.3 查看Dashboard运行的端口"></a>2.3 查看Dashboard运行的端口</h2><pre><code class="hljs shell">kubectl -n kubernetes-dashboard get svc -o wide
NAME                        TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE     SELECTOR
dashboard-metrics-scraper   ClusterIP      10.98.73.37     &lt;none&gt;        8000/TCP        16m     k8s-app=dashboard-metrics-scraper
kubernetes-dashboard        NodePort       10.111.244.42   &lt;none&gt;        443:30307/TCP   16m     k8s-app=kubernetes-dashboard
<span class="hljs-meta prompt_"># </span><span class="language-bash">浏览器输入https://node地址:30307(端口)</span>
language-shell复制代码</code></pre>

<hr>
<h1 id="第三章-kubesphere"><a href="#第三章-kubesphere" class="headerlink" title="第三章 kubesphere"></a>第三章 kubesphere</h1><h2 id="3-1-kubesphere-前置要求"><a href="#3-1-kubesphere-前置要求" class="headerlink" title="3.1 kubesphere 前置要求"></a>3.1 kubesphere 前置要求</h2><blockquote>
<p>Kubernetes 版本必须为：1.17.x、1.18.x、1.19.x 或 1.20.x<br>确保您的机器满足最低硬件要求：CPU &gt; 1 核，内存 &gt; 2 GB<br>在安装之前，需要配置 Kubernetes 集群中的默认存储类型</p>
</blockquote>
<hr>
<h2 id="3-2-k8s安装指定的版本"><a href="#3-2-k8s安装指定的版本" class="headerlink" title="3.2 k8s安装指定的版本"></a>3.2 k8s安装指定的版本</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">查看可安装的k8s版本</span>
yum list kubelet kubeadm kubectl  --showduplicates|sort -r
<span class="hljs-meta prompt_"># </span><span class="language-bash">k8s安装指定的版本</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">Kubernetes 版本必须为：1.17.x、1.18.x、1.19.x 或 1.20.x</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">所以就安装了1.20.x</span>
yum install kubelet-1.20.1-0 kubeadm-1.20.1-0 kubectl-1.20.1-0
language-shell复制代码</code></pre>

<hr>
<h2 id="3-3-创建存储类型"><a href="#3-3-创建存储类型" class="headerlink" title="3.3 创建存储类型"></a>3.3 创建存储类型</h2><blockquote>
<p>因为公司只有俩台服务,node节点性能和硬盘较大， 所以在node节点上部署存储服务，使用的是nfs。</p>
</blockquote>
<hr>
<h2 id="3-4-创建nfs服务端"><a href="#3-4-创建nfs服务端" class="headerlink" title="3.4 创建nfs服务端"></a>3.4 创建nfs服务端</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">创建共享目录,(目录可自定义)</span>
mkdir -p /data/kubernetes
<span class="hljs-meta prompt_"># </span><span class="language-bash">安装组件</span>
yum -y install nfs-utils rpcbind
<span class="hljs-meta prompt_"># </span><span class="language-bash">编辑配置文件</span>
vim /etc/exports
<span class="hljs-meta prompt_"># </span><span class="language-bash">写入内容如下</span>
/data/kubernetes 192.168.18.0/24(rw,sync,no_root_squash)
<span class="hljs-meta prompt_"># </span><span class="language-bash">这里的192.168.18.0/24，表示客户端访问白名单。只有符合的ip，才能访问</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">启动nfs服务</span>
service nfs start
service rpcbind start
<span class="hljs-meta prompt_"># </span><span class="language-bash">设置开机启动</span>
systemctl enable nfs
systemctl enable rpcbind
language-shell复制代码</code></pre>

<hr>
<h2 id="3-5-客户端使用nfs"><a href="#3-5-客户端使用nfs" class="headerlink" title="3.5 客户端使用nfs"></a>3.5 客户端使用nfs</h2><blockquote>
<p>在master安装nfs客户端</p>
</blockquote>
<pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">登录主机k8s-master，创建目录</span>
mkdir nfsvolume
<span class="hljs-meta prompt_"># </span><span class="language-bash">下载yaml文件</span>
https://raw.githubusercontent.com/kubernetes-incubator/external-storage/master/nfs-client/deploy/rbac.yaml
https://raw.githubusercontent.com/kubernetes-incubator/external-storage/master/nfs-client/deploy/class.yaml
https://raw.githubusercontent.com/kubernetes-incubator/external-storage/master/nfs-client/deploy/deployment.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">修改 deployment.yaml 中的两处 NFS 服务器 IP 和目录</span>
...
          env:
            - name: PROVISIONER_NAME
              value: fuseim.pri/ifs
            - name: NFS_SERVER
              value: 192.168.18.199
            - name: NFS_PATH
              value: /data/kubernetes
      volumes:
        - name: nfs-client-root
          nfs:
            server: 192.168.18.199
            path: /data/kubernetes
<span class="hljs-meta prompt_"># </span><span class="language-bash">部署创建</span>
kubectl create -f rbac.yaml
kubectl create -f class.yaml
kubectl create -f deployment.yaml
language-shell复制代码
<span class="hljs-meta prompt_"># </span><span class="language-bash">每个节点都要安装nfs-tuils</span>
yum -y install nfs-utils
<span class="hljs-meta prompt_"># </span><span class="language-bash">在master执行</span>
kubectl get storageclass
<span class="hljs-meta prompt_"># </span><span class="language-bash">以下是终端打印示例内容</span>
NAME                            PROVISIONER      AGE
managed-nfs-storage    fuseim.pri/ifs   139m
<span class="hljs-meta prompt_"># </span><span class="language-bash">查看nfs pod, 确保状态正常</span>
kubectl get pods
NAME                                      READY   STATUS    RESTARTS   AGE
nfs-client-provisioner-59777fb457-dkf87   1/1     Running   0          153m
<span class="hljs-meta prompt_"># </span><span class="language-bash">标记一个默认的StorageClass</span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">最多只有一个StorageClass能够标记为默认</span>
kubectl patch storageclass managed-nfs-storage -p &#x27;&#123;&quot;metadata&quot;: &#123;&quot;annotations&quot;:&#123;&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;&#125;&#125;&#125;&#x27;
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">验证标记是否成功</span>
kubectl get storageclass
NAME                            PROVISIONER      AGE
managed-nfs-storage (default)   fuseim.pri/ifs   139m
language-shell复制代码</code></pre>

<hr>
<h2 id="3-6-安装kubeSphere"><a href="#3-6-安装kubeSphere" class="headerlink" title="3.6 安装kubeSphere"></a>3.6 安装kubeSphere</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">安装的kubesphere 3.1.1</span>
kubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.1.1/kubesphere-installer.yaml   
kubectl apply -f https://github.com/kubesphere/ks-installer/releases/download/v3.1.1/cluster-configuration.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">检查安装日志</span>
kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l app=ks-install -o jsonpath=&#x27;&#123;.items[0].metadata.name&#125;&#x27;) -f
<span class="hljs-meta prompt_"># </span><span class="language-bash">使用 kubectl get pod --all-namespaces 查看所有 Pod 是否在 KubeSphere 的相关命名空间中正常运行。如果是，请通过以下命令检查控制台的端口（默认为 30880）:</span>
kubectl get svc/ks-console -n kubesphere-system
<span class="hljs-meta prompt_"># </span><span class="language-bash">确保在安全组中打开了端口 30880，并通过 NodePort (IP:30880) 使用默认帐户和密码 (admin/P@88w0rd) 访问 Web 控制台。</span>
language-shell复制代码</code></pre>

<hr>
<h1 id="第四章-error"><a href="#第四章-error" class="headerlink" title="第四章 error"></a>第四章 error</h1><h2 id="4-1-关于prometheus-k8s-0-启动失败，一直-pending-状态。"><a href="#4-1-关于prometheus-k8s-0-启动失败，一直-pending-状态。" class="headerlink" title="4.1 关于prometheus-k8s-0 启动失败，一直 pending 状态。"></a>4.1 关于prometheus-k8s-0 启动失败，一直 pending 状态。</h2><blockquote>
<p>虽然kubesphere安装成功，但是健康检测服务可能没起来<br>主要原因是没有pvc<br><a target="_blank" rel="noopener" href="https://kubesphere.com.cn/forum/d/5445-prometheus-k8s-0-pending">参考连接</a></p>
</blockquote>
<pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">创建pvc</span>
vim pvc.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">写入以下内容</span>
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: test-pvc
  annotations:
    volume.beta.kubernetes.io/storage-class: &quot;managed-nfs-storage&quot;
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 21Gi
<span class="hljs-meta prompt_"># </span><span class="language-bash">执行pvc.yaml</span>
kubectl create -f pvc.yaml
<span class="hljs-meta prompt_"># </span><span class="language-bash">验证是否成功</span>
kubectl get pvc
language-shell复制代码</code></pre>

<blockquote>
<p>修改&#x2F;etc&#x2F;kubernetes&#x2F;manifests&#x2F;kube-apiserver.yaml</p>
</blockquote>
<pre><code class="hljs yaml"><span class="hljs-comment"># 在以下内容</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">containers:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">command:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">kube-apiserver</span>
<span class="hljs-comment"># 加入这行</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">--feature-gates=RemoveSelfLink=false</span>
<span class="hljs-comment"># 执行</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">apply</span> <span class="hljs-string">-f</span> <span class="hljs-string">/etc/kubernetes/manifests/kube-apiserver.yaml</span>
<span class="hljs-string">language-yaml复制代码</span></code></pre>

<hr>
<h2 id="4-2-cni0问题"><a href="#4-2-cni0问题" class="headerlink" title="4.2 cni0问题"></a>4.2 cni0问题</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">可以使用类似以下的命令查看pod的运行描述信息</span>
kubectl describe pod coredns-*** -n kube-system
<span class="hljs-meta prompt_"># </span><span class="language-bash">发现报错信息为类似<span class="hljs-string">&quot;network: failed to set bridge addr: &quot;</span>cni0<span class="hljs-string">&quot; already has an IP address different from 10.244.0.1/24&quot;</span></span>
language-shell复制代码</code></pre>

<p><strong>解决办法</strong></p>
<blockquote>
<p>该方法会重置集群！！！！！该方法会重置集群！！！！！该方法会重置集群！！！！！该方法会重置集群！！！！！</p>
</blockquote>
<pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">在所有节点（master和slave节点）删除cni0，以及暂停k8s和docker。</span>
kubeadm reset 
systemctl stop kubelet
systemctl stop docker
rm -rf /var/lib/cni/
rm -rf /var/lib/kubelet/
rm -rf /etc/cni/
ifconfig cni0 down
ifconfig flannel.1 down
ifconfig docker0 down
ip link delete cni0
ip link delete flannel.1
<span class="hljs-meta prompt_"># </span><span class="language-bash">在所有节点重启kubelet和docker</span>
systemctl start kubelet
systemctl start docker
<span class="hljs-meta prompt_"># </span><span class="language-bash">重新创建集群</span>
language-shell复制代码</code></pre>

<hr>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以邮件至 hjxstart@126.com </span>
    </div>
</article>








    




    </div>
    <div class="copyright">
        <p class="footer-entry"><span class="miit">
                <img src="/img/gov.png" title="中华人民共和国工业和信息化部">
                <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">粤ICP备2021170625号-1</a>
        </span>
    
    ©2019-2022 hjxstart
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("/img/article-list-bg-img.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
